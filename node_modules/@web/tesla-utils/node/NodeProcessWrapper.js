
/**
 * Log uncaught node exceptions
 */
var NodeProcessWrapper = function(logger){

    var errors = [];
    var status = "RUNNING";

	logger = logger || console;

    // Start reading from stdin so we don't exit.
	process.stdin.resume();

    // if CTRL+C kills process
	process.on('SIGINT', function(){
		logger.info('Got SIGINT.  Press Control-D to exit.');
        status = "NOT_RUNNING";
	});
		
	// listen for uncaught exceptions
    process.on('uncaughtException', function(err){
    	console.log('NodeProcessWrapper', 'uncaughtException', err);
        logger.error(err);
        errors.push(err);
    });


    return {

        status: function(){
            return status;
        },

        uptime: function(){
            return process.uptime();
        },

        abort: function(){
            process.abort();
        },

        getErrors: function(){
            return errors;
        }

    }

};


module.exports = NodeProcessWrapper;