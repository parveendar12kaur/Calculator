window.tslaHeader = function() {
  var tslaBodyTag = document.body;
  var tslaMenuMask = document.getElementById('tsla-header-mask');
  var tslaMenuHeader = document.getElementById('tsla-header-main');
  var tslaMenuCheckbox = document.getElementById('tsla-header-main--trigger');
  var tslaHeaderCheckboxes = document.getElementsByClassName('tsla-header-checkbox');
  var tslaHeaderNavContainer = document.querySelector('.tsla-header-nav');
  var tslaLastScrollTop = 0;

  // uncheck all the checkboxes
  function uncheckCheckboxes(elements) {
    if (elements.length) {
      for (var i = 0; i < elements.length; i++) {
        elements[i].checked=false;
      }
    }
  }

  // if the browser window is greater than or equal to 640, uncheck checkboxes
  function tslaResize() {
    if (window.innerWidth >= 640) {
      uncheckCheckboxes(tslaHeaderCheckboxes);
      tslaBodyTag.classList.remove('tsla-prevent-scroll');
    }
  }

  // if user has scrolled the page up, reveal header
  // if user has scrolled the page down, conceal header
  function tslaPageScrolling(e) {
    var tslaCurrentScrollTop = window.pageYOffset || tslaBodyTag.scrollTop;
    if (Math.abs(tslaCurrentScrollTop) > Math.abs(tslaLastScrollTop)) {
      tslaBodyTag.classList.add('tsla-header-scrolled');
    } else {
      tslaBodyTag.classList.remove('tsla-header-scrolled');
    }
    tslaLastScrollTop = tslaCurrentScrollTop;
  }

  // intercept touchmove events and prevent all interactions on given element `e`
  function tslaInterceptTouchMove(e) {
    e.preventDefault();
    e.stopPropagation();
  }

  // if user clicks on the 'mask', uncheck all the checkboxes
  tslaMenuMask.addEventListener('click', function() {
    if (tslaMenuCheckbox.checked) {
      uncheckCheckboxes(tslaHeaderCheckboxes);
      tslaBodyTag.classList.remove('tsla-prevent-scroll');
    }
  });


  // if user clicks on the menu opener, add/remove a class to the body tag
  tslaMenuCheckbox.addEventListener('click', function() {
    if (tslaMenuCheckbox.checked) {
      tslaBodyTag.classList.add('tsla-prevent-scroll');
    } else {
      tslaBodyTag.classList.remove('tsla-prevent-scroll');
      uncheckCheckboxes(tslaHeaderCheckboxes);
    }
  });

  // listen for the window resize event
  window.addEventListener('resize', tslaResize);

  // Detect scroll event and fire scrolling event
  document.addEventListener("scroll", tslaPageScrolling, false);

  // listen for and intercept touchmove events
  tslaMenuMask.addEventListener('touchmove', tslaInterceptTouchMove);
}
