const path = require('path');
const chai = require('chai');
const expect = chai.expect;

const Agent = require(path.resolve(__dirname, '../dist'));
const utils = require(path.resolve(__dirname, 'utils.js'));

describe('Agent', () => {

    it('should expose methods', () => {
        let exposedMethods = [
            'toggleOption',
            'toggleOptions',
            'validateRules',
            'validatePrice',
            'validateRulesAndPrice',
            'validate',
            'validatePromise',
            'validateObservable$',
            'getSubTotal',
            'getMarketingConfiguration',
            'mapOptions',
            'transform',
            'transformPromise',
            'transformObservable$',
            'getAllPossibleConfiguration',
            'migrate',
            'upgrade',
            'matching'
        ];
        exposedMethods.forEach(method => {
            expect(!!Agent[method]).to.equal(true);
            expect(utils.isFunction(Agent[method])).to.equal(true);
        })
    });

    it('should expose attributes', () => {
        expect(!!Agent.Lexicon).to.equal(true);
        expect(!!Agent.TYPES).to.equal(true);
        expect(!!Agent.version).to.equal(true);
    });

    it('should expose the same version', () => {
        const versionInPackage = require('../package.json').version;
        expect(Agent.version).to.equal(versionInPackage);
    });
});