const path = require('path');
const MARKETING_TO_MANUFACTURING_LEXICON_DATA = require(path.resolve(__dirname, 'fixtures/marketingToManufacturingTransformLexicon.json'));
const MANUFACTURING_LEXICON_DATA = require(path.resolve(__dirname, 'fixtures/manufacturingLexicon.json'));
const DUMMY_MARKETING_LEXICON = {
    "name": "Dummy Marketing Lexicon",
    "groups": [{
            "name": "$GROUP0",
            "code": "$GROUP0",
            "context": "default",
            "groups": [
                "$GROUP1",
                "$GROUP2"
            ],
            "required": true,
            "exclusive": false
        },{
            "name": "$GROUP1",
            "code": "$GROUP1",
            "context": "default",
            "options": [
                "$AAAA",
                "$BBBB"
            ],
            "required": true,
            "exclusive": true
        },
        {
            "name": "$GROUP2",
            "code": "$GROUP2",
            "context": "default",
            "options": [
                "$CCCC",
                "$DDDD",
                "$EEEE",
                "$FFFF",
                "$GGGG"
            ],
            "required": false,
            "exclusive": false
        }
    ],
    "options": {
        "$AAAA": {
            "code": "$AAAA",
            "price": 0,
            "set_rules": [{
                "action": "set",
                "target": "$AAAA"
            },
            {
                "action": "unset",
                "target": "$BBBB"
            }],
            "unset_rules": [{
                "action": "unset",
                "target": "$AAAA"
            },
            {
                "action": "set",
                "target": "$BBBB"
            }]
        },
        "$BBBB": {
            "code": "$BBBB",
            "price": 0,
            "set_rules": [{
                "action": "set",
                "target": "$BBBB"
            },
            {
                "action": "unset",
                "target": "$AAAA"
            }],
            "unset_rules": [{
                "action": "unset",
                "target": "$BBBB"
            },
            {
                "action": "set",
                "target": "$AAAA"
            }]
        },
        "$CCCC": {
            "code": "$CCCC",
            "price": 0,
            "set_rules": [{
                    "action": "set",
                    "target": "$CCCC"
                }
            ],
            "unset_rules": [{
                    "action": "unset",
                    "target": "$CCCC"
                }
            ]
        },
        "$DDDD": {
            "code": "$DDDD",
            "price": 0,
            "set_rules": [{
                "action": "set",
                "target": "$DDDD"
            }],
            "unset_rules": [{
                    "action": "unset",
                    "target": "$DDDD"
                }
            ]
        },
        "$EEEE": {
            "code": "$EEEE",
            "price": 0,
            "set_rules": [{
                    "action": "set",
                    "target": "$EEEE"
                }
            ],
            "unset_rules": [{
                "action": "unset",
                "target": "$EEEE"
            }]
        },
        "$FFFF": {
            "code": "$FFFF",
            "price": 0,
            "set_rules": [{
                    "action": "set",
                    "target": "$FFFF"
                }
            ],
            "unset_rules": [{
                "action": "unset",
                "target": "$FFFF"
            }]
        },
        "$GGGG": {
            "code": "$GGGG",
            "price": 0,
            "set_rules": [{
                    "action": "set",
                    "target": "$GGGG"
                }
            ],
            "unset_rules": [{
                    "action": "unset",
                    "target": "$GGGG"
                }
            ]
        }
    },
    "base_configuration": [
        "$AAAA"
    ],
    "effective_date": "2017-04-10T00:57:42.650Z",
    "province": null,
    "market": "US",
    "product": "m3",
    "language": "en",
    "id": 1
};

function generateConfigurationByOptionList(optionList = []) {
	let configuration = {
		options: []
	};
	optionList.forEach(option => {
		configuration.options.push({
			code: option,
			price: 0
		});
	});
	return configuration;
}

function generateMarketingToManufacturingLexicon(market) {
	let marketing_lexicon = Object.assign({}, DUMMY_MARKETING_LEXICON, {market});
	return [marketing_lexicon, MARKETING_TO_MANUFACTURING_LEXICON_DATA, MANUFACTURING_LEXICON_DATA];
}

function isFunction(x) {
    return typeof x === 'function';
}

function getOptionListFromMappedOptionsResult(mappedResult) {
    let options = mappedResult.data.options.map(option => option.code);
    return options.sort();
}

module.exports = {
	generateConfigurationByOptionList,
	generateMarketingToManufacturingLexicon,
    isFunction,
    getOptionListFromMappedOptionsResult
};
