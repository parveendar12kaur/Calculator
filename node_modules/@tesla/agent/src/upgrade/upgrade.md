## All Upgradable Cases:

| ID | Source Configuration  | Upgradable | Upgraded configuration | Upgrade Option Code  |
| -  | -                     | -          | -                      | -                    |
| 1  | $BT35                 | Y          | $BT37                  | $BT37                |
| 2  | $BT35                 | Y          | $BT35, $APPB           | $APPB                |
| 3  | $BT35                 | Y          | $BT35, $APPB, $APF2    | $APF2                |
| 4  | $BT35                 | Y          | $BT35, $APPB, $APF2    | $APPB, $APF2         |
| 5  | $BT35                 | Y          | $BT37, $APPB           | $BT37, $APPB         |
| 6  | $BT35                 | Y          | $BT37, $APPB, $APF2    | $BT37, $APF2         |
| 7  | $BT35                 | Y          | $BT37, $APPB, $APF2    | $BT37, $APPB, $APF2  |
| 8  | $BT37                 | Y          | $BT37, $APPB           | $APPB                |
| 9  | $BT37                 | Y          | $BT37, $APPB, $APF2    | $APF2                |
| 10 | $BT37                 | Y          | $BT37, $APPB, $APF2    | $APPB, $APF2         |
| 11 | $BT35, $APPB          | Y          | $BT35, $APPB, $APF2    | $APF2                |
| 12 | $BT35, $APPB          | Y          | $BT37, $APPB           | $BT37                |
| 13 | $BT35, $APPB          | Y          | $BT37, $APPB, $APF2    | $BT37, $APF2         |
| 14 | $BT37, $APPB          | Y          | $BT37, $APPB, $APF2    | $APF2                |
| 15 | $BT35, $APPB, $APF2   | Y          | $BT37, $APPB, $APF2    | $BT37                |
| 16 | $BT37, $APPB, $APF2   | N          | -                      | -                    |



## Note:
* Only `$BT37`, `$APPB`, `$APF2` are upgradable option codes
* `$BT37` has a limitation, you can only upgrade from `$BT35` if we start selling more long-range batteries
* `$APPB`, `$APF2` doesn't have limitation, if you don't have it, you are upgradable
* The relationship between $APPB/$APF2 are covered by the rules in `lexicon.options`


## Upgrade lexicon defination:

```
{
    "groups": [],
    "options": {},
    "metadata": {
        "post_mfg_mutations": {
            "$APF2": {
                "type": "remote",
                "mutation": [], // If you don't have $APF2, you are eligible to get the upgrade
                "requirement_relationship": 'and'
            },
            "$APPB": {
                "type": "remote",
                "mutation": [], // If you don't have $APPB, you are eligible to get the upgrade
                "requirement_relationship": 'and'
            },
            "$BT37": {
                "type": "service_center",
                "mutation": ['$BT35'], // So you can only upgrade $BT35 to $BT37 if we start selling more batteries
                "requirement_relationship": 'and'
            },
            "$DV4W": {
                "type": "not_available",
                "mutation": ['$DV2W'], // So you can only upgrade $DV2W to $DV4W
                "requirement_relationship": 'and'
            },
            "$APF3": {
                "type": "not_available",
                "mutation": ['$APF2', '$BT37'], // You are eligible to get the upgrade if you have either $APF2 or $BT37
                "requirement_relationship": 'or'
            }
        }
    }
}
```

## Upgrade process

1. Valid the given configuration
2. Get the upgradable option list from `upgrade lexicon`
3. Get the combination of the upgradable option list from step 2
4. Iterate the combination list above, run setOption to get the upgraded potential configuration

